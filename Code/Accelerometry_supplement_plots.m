load('supplement_plot_data.mat');
%% Figure 1a
figure
r = 5;
plot(tone_x(:,1:5),tones_presses_norm(r,1:5),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);
ylabel('Normalized Score')
ylim([0 1.1])
hold on

xticks([1 3 5 6 8 10 12 13 15 17 19 21 23 25 27 29 31 33 35 37])
xticklabels({1 3 5 1 3 5 7 1 3 5 7 9 11 13 15 17 19 1 3 5});
 
plot(tone_x(:,1:5),tones_acc_norm(r,1:5),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);

plot(tone_x(:,1:5),OB13_pf_inverse(:,1:5),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);

plot(tone_x(:,6:12),tones_presses_norm(r,6:12),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);
plot(tone_x(:,13:32),tones_presses_norm(r,13:32),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);
plot(tone_x(:,33:38),tones_presses_norm(r,33:38),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);

%

plot(tone_x(:,6:12),OB13_pf_inverse(:,6:12),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);
plot(tone_x(:,13:32),OB13_pf_inverse(:,13:32),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);
plot(tone_x(:,33:38),OB13_pf_inverse(:,33:38),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);

%
plot(tone_x(:,6:12),tones_acc_norm(r,6:12),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);
plot(tone_x(:,13:32),tones_acc_norm(r,13:32),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);
plot(tone_x(:,33:38),tones_acc_norm(r,33:38),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);

xline(5.5,'--','LineWidth',5,'Color','k')
xline(12.5,'--','LineWidth',5,'Color','k')
xline(32.5,'--','LineWidth',5,'Color','k')

t1 = text(2.5,1.05,'Hab');
t2 = text(8.75,1.05,'Con');
t3 = text(22,1.05,'Ext');
t4 = text(36,1.05,'Re');

legend({'Binned Bar Press','Smoothed Accelerometry Change','1 - Percent Freezing'},'AutoUpdate','off');

%% Figure 1b
figure
errorbar(tone_x(:,1:5),mean(tones_presses_norm(:,1:5)),tones_presses_norm_SEM(:,1:5),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);
%xlabel('Tone')
ylabel('Normalized Score')
ylim([-.2 1.2])
hold on

xticks([1 3 5 6 8 10 12 13 15 17 19 21 23 25 27 29 31 33 35 37])
xticklabels({1 3 5 1 3 5 7 1 3 5 7 9 11 13 15 17 19 1 3 5});
 
errorbar(tone_x(:,1:5),mean(tones_acc_norm(:,1:5)),tones_acc_norm_SEM(:,1:5),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);

errorbar(tone_x(:,1:5),mean(pf_inverse(:,1:5)),pf_inverse_SEM(:,1:5),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);


errorbar(tone_x(:,6:12),mean(tones_presses_norm(:,6:12)),tones_presses_norm_SEM(:,6:12),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);
errorbar(tone_x(:,13:32),mean(tones_presses_norm(:,13:32)),tones_presses_norm_SEM(:,13:32),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);
errorbar(tone_x(:,33:38),mean(tones_presses_norm(:,33:38)),tones_presses_norm_SEM(:,33:38),'-o',...
    'Color',[0 0 1],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0 0 1],...
    'MarkerFaceColor',[0 0 1],...
    'MarkerSize',10);

%

errorbar(tone_x(:,6:12),mean(pf_inverse(:,6:12)),pf_inverse_SEM(:,6:12),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);
errorbar(tone_x(:,13:32),mean(pf_inverse(:,13:32)),pf_inverse_SEM(:,13:32),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);
errorbar(tone_x(:,33:38),mean(pf_inverse(:,33:38)),pf_inverse_SEM(:,33:38),'-o',...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.8500 0.3250 0.0980],...
    'MarkerFaceColor',[0.8500 0.3250 0.0980],...
    'MarkerSize',10);

%
errorbar(tone_x(:,6:12),mean(tones_acc_norm(:,6:12)),tones_acc_norm_SEM(:,6:12),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);
errorbar(tone_x(:,13:32),mean(tones_acc_norm(:,13:32)),tones_acc_norm_SEM(:,13:32),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);
errorbar(tone_x(:,33:38),mean(tones_acc_norm(:,33:38)),tones_acc_norm_SEM(:,33:38),'-o',...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',8,...
    'MarkerEdgeColor',[0.4660 0.6740 0.1880],...
    'MarkerFaceColor',[0.4660 0.6740 0.1880],...
    'MarkerSize',10);

xline(5.5,'--','LineWidth',2,'Color','k')
xline(12.5,'--','LineWidth',2,'Color','k')
xline(32.5,'--','LineWidth',2,'Color','k')

t1 = text(2,1.18,'Hab');
t2 = text(8,1.18,'Con');
t3 = text(21,1.18,'Ext');
t4 = text(35,1.18,'Re');

%% Figure 2a 
stem(lags,mean_all_cross_correlations)
yticks([0 0.2 0.4 0.6 0.8 1])
yticklabels({0 0.2 0.4 0.6 0.8 1});
xticks([-20 -15 -10 -5 0 5 10 15 20])
xticklabels({-2 -1.5 -1 -0.5 0 0.5 1 1.5 2});
ylabel('Cross Correlation')
xlabel('Lag (seconds)')
title('Freezing x Accelerometry Cross Correlation')
hold on
stem(lags(:,find(mean_all_cross_correlations == max(mean_all_cross_correlations))),max(mean_all_cross_correlations),'r')

%% Figure 2b
stem(lags,corrected_cross_correlation)
ylim([-0.002 0.01])
yticks([-0.002 0 0.002 0.004 0.006 0.008 0.01])
yticklabels({-0.002 0 0.002 0.004 0.006 0.008 0.01});
xticks([-20 -15 -10 -5 0 5 10 15 20])
xticklabels({-2 -1.5 -1 -0.5 0 0.5 1 1.5 2});
hold on
ylabel('Cross Correlation')
xlabel('Lag (seconds)')
title('Corrected Cross Correlation')
stem(lags(:,find(corrected_cross_correlation == max(corrected_cross_correlation))),max(corrected_cross_correlation),'r')

%% Figure 3a WORK IN PROGRESS
figure
plot(time_zero_10hz(9481:9881,:),bp_norm_10(9481:9881,:),...
    'Color',[0 0 1],...
    'LineWidth',4);
xlim([950 986]) 
ylim([0 1])
xlabel('Time (seconds)')
title('Sampling rate:10Hz Smoothing Kernel:1s ')
hold on

 
plot(time_zero_10hz(9481:9881,:),acc_norm_10(9481:9881,:),...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',4);

plot(time_zero_10hz(9481:9881,:),fs_norm_10(9481:9881,:),...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',4);


legend({'Smoothed Bar Press','Smoothed Accelerometry Change','Smoothed Freezing Score'},'AutoUpdate','off');


x = [953 983 983 953];
y = [-.3 -.3 1.3 1.3];   
patch(x,y,'red','FaceAlpha','.1')
 xline(953,'r','LineWidth',2)
 xline(983,'k','LineWidth',2)

%% Figure 3b 
figure
plot(time_zero_10hz(9481:9881,:),bp_norm_30(9481:9881,:),...
    'Color',[0 0 1],...
    'LineWidth',4);
xlim([950 986]) 
ylim([0 1])
xlabel('Time (seconds)')
title('Sampling rate:10Hz Smoothing Kernel:3s ')
hold on

 
plot(time_zero_10hz(9481:9881,:),acc_norm_30(9481:9881,:),...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',4);

plot(time_zero_10hz(9481:9881,:),fs_norm_30(9481:9881,:),...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',4);


legend({'Smoothed Bar Press','Smoothed Accelerometry Change','Smoothed Freezing Score'},'AutoUpdate','off');


x = [953 983 983 953];
y = [-.3 -.3 1.3 1.3];   
patch(x,y,'red','FaceAlpha','.1')
 xline(953,'r','LineWidth',2)
 xline(983,'k','LineWidth',2)

%% Figure 3c
figure
plot(time_zero_24hz(22754:23714,:),bp_smooth_24_norm(22754:23714,:),...
    'Color',[0 0 1],...
    'LineWidth',4);
xlim([950 986]) 
ylim([0 1])
xlabel('Time (seconds)')
title('Sampling rate:24Hz Smoothing Kernel:6s ')
hold on

 
plot(time_zero_24hz(22754:23714,:),acc_diff_24_norm(22754:23714,:),...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',4);

plot(time_zero_24hz(22754:23714,:),fs_24_norm(22754:23714,:),...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',4);


legend({'Smoothed Bar Press','Smoothed Accelerometry Change','Smoothed Freezing Score'},'AutoUpdate','off');


x = [953 983 983 953];
y = [-.3 -.3 1.3 1.3];   
patch(x,y,'red','FaceAlpha','.1')
 xline(953,'r','LineWidth',2)
 xline(983,'k','LineWidth',2)

%% Figure 3d
figure
plot(time_zero_100hz(94810:98810,:),bp_smooth_100_norm(94810:98810,:),...
    'Color',[0 0 1],...
    'LineWidth',4);
xlim([950 986]) 
ylim([0 1])
xlabel('Time (seconds)')
title('Sampling rate:100Hz Smoothing Kernel:6s ')
hold on

 
plot(time_zero_100hz(94810:98810,:),acc_diff_100_norm(94810:98810,:),...
    'Color',[0.4660 0.6740 0.1880],...
    'LineWidth',4);

plot(time_zero_100hz(94810:98810,:),fs_100_norm(94810:98810,:),...
    'Color',[0.8500 0.3250 0.0980],...
    'LineWidth',4);


legend({'Smoothed Bar Press','Smoothed Accelerometry Change','Smoothed Freezing Score'},'AutoUpdate','off');


x = [953 983 983 953];
y = [-.3 -.3 1.3 1.3];   
patch(x,y,'red','FaceAlpha','.1')
 xline(953,'r','LineWidth',2)
 xline(983,'k','LineWidth',2)

%% Figure 4
figure
shadedErrorBar(PTA_x,All_Norm_PTA,{@mean,@std},'lineprops','-b');
title('Normalized Press Triggered Average')
xlabel('Milliseconds ')
ylabel('Normalized Accelerometer Voltage')
xticks([0 7500 15000 22500 30000 37500 45000 52500 60000])
xticklabels({-1000 -750 -500 -250 0 250 500 750 1000});
hold on
xline(30000,'-',{'Press'},'LineWidth',2,'Color','black')

%% Figure 5
figure
shadedErrorBar(x_PSD,X_PSD_84,{@mean,@std},'lineprops','-r');
xlabel('Frequency (Hz)')
ylabel('Power')
ylim([0 0.0035])
yticks([0 0.001 0.002 0.003])
xticks([0 10 20 30])
title('X')

figure
shadedErrorBar(x_PSD,Y_PSD_84,{@mean,@std},'lineprops','-g');
xlabel('Frequency (Hz)')
ylabel('Power')
ylim([0 0.0035])
yticks([0 0.001 0.002 0.003])
xticks([0 10 20 30])
title('Y')

figure
shadedErrorBar(x_PSD,Z_PSD_84,{@mean,@std},'lineprops','-b');
xlabel('Frequency (Hz)')
ylabel('Power')
ylim([0 0.0035])
yticks([0 0.001 0.002 0.003])
xticks([0 10 20 30])
title('Z')

%% Figure 6a
x_boxplot = [1 2 3 4 5 6 7];
figure
f = boxplot(Mean_accel_gravity_freezing_r2_correlations,'Labels',{'R','RC','S','SC','SSh','SCSh','SCN'},...
    'Colors','k',...
    'symbol','');
set(f,{'linew'},{4});
ylim([-0.0036 0.08])
yticks([0 0.02 0.04 0.06 0.08])
xlabel('Method','fontsize',31)
ylabel('r^2','fontsize',31)
title('Freezing x Acceleration','fontsize',31)
hold on
scatter(x_boxplot,Mean_accel_gravity_freezing_r2_correlations,...
    'MarkerEdgeColor', 'k', 'LineWidth',3)

%% Figure 6b
figure
b = boxplot(Mean_accel_gravity_barpress_r2_correlations,'Labels',{'R','RC','S','SC','SSh','SCSh','SCN'},...
    'Colors','k',...
    'symbol','');
set(b,{'linew'},{4});
ylim([-0.0036 0.3])
xlabel('Method','fontsize',31)
ylabel('r^2','fontsize',31)
title('Bar Press x Acceleration','fontsize',31)
hold on
scatter(x_boxplot,Mean_accel_gravity_barpress_r2_correlations,...
    'MarkerEdgeColor', 'k','LineWidth',3)

%% Figure 6c
figure
g = boxplot(Mean_gravity_freezing_r2_correlations,'Labels',{'R','RC','S','SC','SSh','SCSh','SCN'},...
    'Colors','k',...
    'symbol','');
set(g,{'linew'},{4});
yticks([0 0.02 0.04 0.06])
xlabel('Method','fontsize',31)
ylabel('r^2','fontsize',31)
title('Freezing x Gravity','fontsize',31)
hold on
scatter(x_boxplot,Mean_gravity_freezing_r2_correlations,...
    'MarkerEdgeColor', 'k', 'LineWidth',3)

%% Figure 6d
figure
h = boxplot(Mean_gravity_barpress_r2_correlations,'Labels',{'R','RC','S','SC','SSh','SCSh','SCN'},...
    'Colors','k',...
    'symbol','');
set(h,{'linew'},{4});
xlabel('Method','fontsize',31)
ylabel('r^2','fontsize',31)
title('Bar Press x Gravity','fontsize',31)
hold on
scatter(x_boxplot,Mean_gravity_barpress_r2_correlations,...
    'MarkerEdgeColor', 'k','LineWidth',3)
